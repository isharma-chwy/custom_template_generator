# custom_template_generator
This is a custom excel template generator that creates excel templates based on an input sql query in the queries.py file and the column to split by. 
There is also post processing functionality built out for RX vendor catalog generation.


## How to set up
You must add the following code in the connection_info.py file in the root directory of the project
```
conn_info = {'host': 'bidb.chewy.local',
             'port': 5433,
             #Enter your credentials here
             'user': 'YOUR_USERNAME',
             'password': 'YOUR_PASSWORD',
             'database': 'bidb',
             
             # Feel free to changes the parameters below as needed.
             # autogenerated session label by default,
             'session_label': 'some_label',
             # default throw error on invalid UTF-8 results
             'unicode_error': 'strict',
             # SSL is disabled by default
             'ssl': False,
             # autocommit is off by default
             'autocommit': True,
             # using server-side prepared statements is disabled by default
             'use_prepared_statements': False,
             # connection timeout is not enabled by default
             # 5 seconds timeout for a socket operation (Establishing a TCP connection or read/write operation)
             'connection_timeout': 600}
```
the ```split_dataframe_by_column_unique_values``` function is a generator that generates a dataframe for each unique value in ```column``` and outputs in to the excel template file using the ```create_excel_template``` function.
The excel template file must be placed in the ```template_file_path``` and the ```output_path``` can be specified as an argument to the create_excel_template function.


```
for vendor_name, catalog in split_dataframe_by_column_unique_values(input_df = df_rx_catalog_applicable_vendors, column = 'vendor_name', sortby = 'parent_company'):
    print("Processing Dataframe with ",vendor_name, catalog.shape)
    date_today = pd.to_datetime('today').strftime('%m_%d_%Y')
    create_excel_template(template_df = catalog,
                      template_file_path = 'rx_template.xlsx',
                      template_password = 'mssve',
                      output_path = f'./rx_catalogs_generated/{date_today}/',
                      sheet_name = 'Vendor_Catalog',
                      editable_columns = ['R','S','T','U', 'W', 'X', 'Y', 'Z', 'AA', 'AB', 'AC'],
                      editable_cells = [],
                      start_cell = 'A3',
                      col_val_for_name = 'vendor_name',
                      # cols_to_hide = [],
                      # cols_to_hide = ['A', 'B', 'C'],
                      cols_to_hide = ['A', 'B', 'C', 'AD', 'AE', 'AF', 'AG', 'AH', 'AI', 'AJ', 'AK', 'AL', 'AM', 'AN'],
                      template_name = "rx_catalog",
                      date_cell = 'F2'
                        )
```
